---
import AddToCartButton from './AddToCartButton.vue';
import { formatPrice } from '../../lib/cart';

interface Props {
  name: string;
  slug: string;
  price: number;
  image?: string;
  sku: string;
  productId: number;
  documentId: string;
}

const { name, slug, price, image, sku, productId, documentId } = Astro.props;
---

<article class="group flex flex-col bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg hover:border-primary-300 transition-all duration-200">
  <a href={`/bestellung/produkt/${slug}`} class="block no-underline">
    {image ? (
      <div class="relative h-48 md:h-56 overflow-hidden bg-gray-50">
        <img
          src={image}
          alt={name}
          class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300"
          loading="lazy"
        />
      </div>
    ) : (
      <div class="h-48 md:h-56 bg-gradient-to-br from-gray-100 to-gray-200 flex items-center justify-center">
        <svg class="w-16 h-16 text-gray-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="1">
          <path stroke-linecap="round" stroke-linejoin="round" d="m2.25 15.75 5.159-5.159a2.25 2.25 0 0 1 3.182 0l5.159 5.159m-1.5-1.5 1.409-1.409a2.25 2.25 0 0 1 3.182 0l2.909 2.909M3.75 21h16.5A2.25 2.25 0 0 0 22.5 18.75V5.25A2.25 2.25 0 0 0 20.25 3H3.75A2.25 2.25 0 0 0 1.5 5.25v13.5A2.25 2.25 0 0 0 3.75 21Z" />
        </svg>
      </div>
    )}
  </a>

  <div class="flex-1 flex flex-col p-4">
    <a href={`/bestellung/produkt/${slug}`} class="no-underline">
      <h3 class="text-base font-serif font-bold text-gray-900 group-hover:text-primary-700 transition-colors mb-1 leading-snug">
        {name}
      </h3>
    </a>

    <p class="text-xs text-gray-400 mb-2">Art.-Nr.: {sku}</p>

    <p class="text-lg font-bold text-primary-700 mb-3">
      {formatPrice(price)}
    </p>

    <div class="mt-auto">
      <AddToCartButton
        client:load
        productId={productId}
        documentId={documentId}
        name={name}
        slug={slug}
        sku={sku}
        price={price}
        image={image || ''}
      />
    </div>
  </div>
</article>
